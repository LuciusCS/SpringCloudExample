


## ElasticSearch 查询优化
比如说你现在有一行数据。 id,name,age .... 30 个字段。但是你现在搜索，只需要根据
id,name,age 三个字段来搜索。如果往 es 里写入一行数据所有的字段，就会导致说
90% 的数据是不用来搜索的，结果硬是占据了 es 机器上的 filesystem cache 的空间，单
条数据的数据量越大，就会导致 filesystem cahce 能缓存的数据就越少。其实，仅仅写入
es 中要用来检索的少数几个字段就可以了，比如说就写入 es id,name,age 三个字段，然后
你可以把其他的字段数据存在 mysql/hbase 里，我们一般是建议用 es + hbase 这么一个架构。
hbase 的特点是适用于海量数据的在线存储，就是对 hbase 可以写入海量数据，但是不要做
复杂的搜索，做很简单的一些根据 id 或者范围进行查询的这么一个操作就可以了。从 es 中根
据 name 和 age 去搜索，拿到的结果可能就 20 个 doc id ，然后根据 doc id 到 hbase 里去
查询每个 doc id 对应的完整的数据，给查出来，再返回给前端。



## Elasticsearch + HBase 架构 适用于以下场景：
对海量数据进行存储和查询，需要高吞吐量的写入操作同时又要求快速的搜索和分析。
在日志分析、社交媒体分析、电商搜索、推荐系统、实时数据分析等场景中，能够结合 HBase 的数据存储能力和 Elasticsearch 的查询能力，实现高效的数据存储和分析。


## 示例：商品搜索与详情展示
假设我们要在电商平台中实现商品搜索和展示功能，使用 Elasticsearch + HBase 架构。具体步骤如下：
商品数据存储：
商品的基本信息（如名称、描述、价格、库存）存储在 HBase 中。
商品的文本字段（如商品名称、类别等）会被索引到 Elasticsearch 中。
数据同步：
当商品信息新增或更新时，数据首先写入 HBase，同时通过消息队列（如 Kafka）将商品名称、类别等字段同步到 Elasticsearch 中。
搜索与查询：
用户在平台上进行商品搜索时，Elasticsearch 根据商品名称、类别等字段进行搜索，返回符合条件的商品 ID 和其他相关信息。
根据搜索结果，Elasticsearch 会从 HBase 中检索商品的 详细信息（如价格、库存、描述等），并将最终结果返回给用户。
返回搜索结果：
Elasticsearch 仅返回 商品 ID 和 匹配度 排名，详细商品信息从 HBase 中查询获取。这样，Elasticsearch 可以快速响应搜索请求，HBase 提供数据存储和高吞吐量的查询支持。